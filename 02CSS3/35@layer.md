<!-- TOC -->

- [@layer](#layer)
  - [åŠŸèƒ½ä¸ä¼˜å…ˆçº§](#%E5%8A%9F%E8%83%BD%E4%B8%8E%E4%BC%98%E5%85%88%E7%BA%A7)
  - [è¯­æ³•](#%E8%AF%AD%E6%B3%95)
  - [åˆ›å»ºçº§è”å±‚çš„ä¸‰ç§æ–¹å¼](#%E5%88%9B%E5%BB%BA%E7%BA%A7%E8%81%94%E5%B1%82%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F)
  - [åµŒå¥—çš„ @layer](#%E5%B5%8C%E5%A5%97%E7%9A%84-layer)
    - [å†…å±‚çš„ä¼˜å…ˆçº§.](#%E5%86%85%E5%B1%82%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7)
  - [@layer ä¸ !important](#layer-%E4%B8%8E-important)
  - [æµè§ˆå™¨å…¼å®¹æ€§](#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E6%80%A7)

<!-- /TOC -->

# @layer
> `@layer` CSS è§„åˆ™ç”¨æ¥å£°æ˜ä¸€ä¸ªçº§è”å±‚(cascade layer), å¹¶ä¸”åœ¨å¤šä¸ªçº§è”å±‚çš„æƒ…å†µä¸‹å®šä¹‰ä¼˜å…ˆçº§.
## åŠŸèƒ½ä¸ä¼˜å…ˆçº§
çº§è”å±‚åˆ°åº•æœ‰ä»€ä¹ˆç”¨å‘¢? æˆ‘ä»¬çŸ¥é“ä¸åŒæ¥æºçš„ CSS è§„åˆ™æœ‰ç€ä¸åŒçš„ä¼˜å…ˆçº§, æ¯”å¦‚ web å¼€å‘è€…ç¼–å†™çš„ CSS æ ·å¼è¡¨(author stylesheets) æ¯”æµè§ˆå™¨é»˜è®¤çš„æ ·å¼(user-agent stylesheets) çš„ä¼˜å…ˆçº§æ›´é«˜. å¯ä»¥å°†ä¸åŒä¼˜å…ˆçº§çš„è§„åˆ™ç†è§£ä¸ºçº§è”è§„åˆ™.

ä½¿ç”¨çº§è”å±‚, å¼€å‘è€…å¯ä»¥æ›´çµæ´»åœ°æ§åˆ¶çº§è”è§„åˆ™. å†™åœ¨çº§è”å±‚ A ä¸­çš„ CSS è§„åˆ™ä¸å†™åœ¨çº§è”å±‚ B ä¸­çš„ CSS è§„åˆ™å®Œå…¨æ²¡æœ‰å…³ç³», ç©¶ç«Ÿå“ªä¸ªè§„åˆ™ç”Ÿæ•ˆ? `åªä¸`çº§è”å±‚æœ‰å…³ç³». å› æ­¤, å½“æˆ‘ä»¬æƒ³è¦å¼•å…¥ç¬¬ä¸‰æ–¹æ ·å¼æ–‡ä»¶åˆä¸æƒ³è®©ç¬¬ä¸‰æ–¹æŸäº›ä¼˜å…ˆçº§è¿‡é«˜çš„ CSS è§„åˆ™è¦†ç›–åŸæœ¬çš„é‡åçš„è§„åˆ™, å°±å¯ä»¥åœ¨çº§è”å±‚ä¸­å¼•å…¥.


ä»»ä½•æ²¡æœ‰åœ¨çº§è”å±‚ä¸­å£°æ˜çš„ CSS è§„åˆ™éƒ½ä¼šè¢«èšé›†åœ¨ä¸€èµ·å¹¶è¢«æ”¾å…¥ä¸€ä¸ª`åŒ¿åçš„çº§è”å±‚ä¸­`, è¿™ä¸ªåŒ¿åçš„çº§è”å±‚ä¼šåœ¨æ‰€æœ‰æ‰‹åŠ¨å£°æ˜çš„(declared)ã€æœ‰åå­—çš„(named)å’ŒåŒ¿åçš„çº§è”å±‚ä¹‹å. è¿™æ„å‘³ç€ä»»ä½•æ²¡æœ‰å£°æ˜åœ¨çº§è”å±‚ä¸­çš„ CSS è§„åˆ™éƒ½å°†`è¦†ç›–`å£°æ˜åœ¨çº§è”å±‚ä¸­çš„ CSS è§„åˆ™, å¹¶ä¸”ä¸ CSS è§„åˆ™çš„æƒé‡æ— å…³.

çœ‹ä¸ªä¾‹å­
```html
<div class="box" id="box"></div>
```
```css
.box {
  background-color: pink;
}
@layer power {
  #box {
    height: 100px;
    width: 100px;
    background-color: red;
  }
}
```
ä»ä¸‹å›¾å°±èƒ½çœ‹å‡º, å³ä¾¿çº§è”å±‚ä¸­çš„ CSS è§„åˆ™æƒé‡æ›´é«˜, ä½†æ˜¯ç”Ÿæ•ˆçš„æ˜¯åœ¨çº§è”å±‚å¤–é¢å®šä¹‰çš„ CSS è§„åˆ™. å› æ­¤åœ¨å¼€å‘ä¸­å¯ä»¥æŠŠåŸºç¡€æ ·å¼å†™åœ¨çº§è”å±‚ä¸­, ä¸ªæ€§åŒ–å®šåˆ¶çš„æ ·å¼ä¸å†™åœ¨çº§è”å±‚ä¸­, è¿™æ ·å°±å¯ä»¥è¦†ç›–åŸºç¡€æ ·å¼ä¹Ÿä¸ä¼šè¢«æƒé‡æˆ– CSS è§„åˆ™çš„ä¹¦å†™é¡ºåºå›°æ‰°.
![](../image/Snipaste_2023-01-29_21-32-28.png)

## è¯­æ³•
```css
@layer name { rules }
@layer name;
@layer name1, name2, name3;
@layer { rules }
```
å…¶ä¸­, name æ˜¯æ¯ä¸€ä¸ªçº§è”å±‚çš„åå­—. rules æ˜¯å®šä¹‰åœ¨çº§è”å±‚ä¸­çš„ CSS è§„åˆ™.

## åˆ›å»ºçº§è”å±‚çš„ä¸‰ç§æ–¹å¼
1ï¸âƒ£ ç¬¬ä¸€ç§, åˆ›å»ºä¸€ä¸ªå…·åçš„çº§è”å±‚, å¹¶ä¸”çº§è”å±‚ä¸­æœ‰ CSS è§„åˆ™.
```css
@layer basement {
  .pt-5 {
    padding-top: 5px;
  }
}
```
2ï¸âƒ£ ç¬¬äºŒç§, åˆ›å»ºä¸€ä¸ªå…·åçš„çº§è”å±‚, ä½†æ˜¯æ²¡æœ‰ä»»ä½• CSS è§„åˆ™. è¿™ç§æ–¹å¼åˆ›å»ºä¸€ä¸ªçº§è”å±‚æˆ–åŒæ—¶åˆ›å»ºå¤šä¸ªçº§è”å±‚. åŒæ—¶åˆ›å»ºå¤šä¸ªçº§è”å±‚çš„åŒæ—¶, ä»–ä»¬çš„ä¼˜å…ˆçº§é¡ºåºä¹Ÿç¡®å®šäº†, å³ layout çš„ä¼˜å…ˆçº§æ¯” colors æ›´é«˜.
```css
@layer colors;
@layer colors, layout;
```
ä½†æ˜¯å¦‚æœè¿™å†™æˆè¿™æ ·ä¹Ÿå¾ˆå¥‡æ€ª, å› ä¸ºæ²¡æœ‰å…·ä½“çš„ CSS è§„åˆ™, å› æ­¤åœ¨å£°æ˜ä¹‹åå¯ä»¥é‡å¤å†å£°æ˜ä¸€æ¬¡å¹¶æ·»åŠ  CSS è§„åˆ™, å¹¶ä¸”çº§è”å±‚çš„ä¼˜å…ˆçº§ä¸ä¼šå‘ç”Ÿå˜åŒ–
```css
@layer basement, utilities;
  @layer utilities {
    .pt-5 {
      padding-top: 5px;
    }
  }
  @layer basement {
    html, body {
      padding: 0;
      margin: 0;
    }
  }
```

3ï¸âƒ£ ç¬¬ä¸‰ç§, åˆ›å»ºåŒ¿åçš„çº§è”å±‚. å¦‚æœæ²¡æœ‰åå­—å°±æ— æ³•åœ¨åç»­è¿½åŠ  CSS è§„åˆ™, å…¶ä¼˜å…ˆçº§ä¸å…·åçš„çº§è”å±‚è®¡ç®—è§„åˆ™ä¸€æ ·.
```css
@layer {
  .box1 {
    width: 100px;
    height: 100px;
    border: 1px solid red;
    border-radius: 10px;
  }
}
```

4ï¸âƒ£ å¦å¤–å‘¢, å¦‚æœæƒ³è¦ä½¿ç”¨ @import å¼•å…¥ä¸€ä¸ªå¤–éƒ¨çš„æ ·å¼è¡¨, ä½¿ç”¨ `@import url(...) layer(layerName)`.

æ¥çœ‹æ“ä½œ. é¦–å…ˆåœ¨ html é¡µé¢ä¸­é€šè¿‡ link æ ‡ç­¾å¼•å…¥ index1.css
```css
<link rel="stylesheet" href="index1.css">
```
æ¥ç€åœ¨ index1.css ä¸­å¼•å…¥ index2.css. è¿™æ ·å°±ä¼šç›´æ¥åˆ›å»ºä¸€ä¸ªåä¸º externalLayer çš„çº§è”å±‚.
```css
@import url(index2.css) layer(externalLayer);
```
åœ¨ index2.css ä¸­åˆ›å»ºä¸€äº›æ ·å¼
```css
html, body {
  padding: 0;
  margin: 0;
}
body {
  background-color: #212121;
}
```
æ¥çœ‹ç»“æœ. åœ¨ Chrome 109 å¼€å‘è€…å·¥å…·ä¸­, å·²ç»å¯ä»¥çœ‹åˆ°å¯¹ @layer è§„åˆ™çš„æ”¯æŒ.

![](../image/Snipaste_2023-01-31_09-15-41.png)

å½“ç„¶ `@import url(...) layer(layerName)` ä¹Ÿå¯ä»¥çœç•¥ layerName, è¿™æ ·å°±ä¼šåˆ›å»ºä¸€ä¸ªåŒ¿åçš„çº§è”å±‚.
```css
@import url(index2.css) layer;
```

ğŸ“– è¿™ç§æ–¹æ³•è¦æ³¨æ„ @import è§„åˆ™å¿…é¡»å‡ºç°åœ¨å…¶ä»–æ‰€æœ‰è§„åˆ™ä¹‹å‰, é™¤äº† @charset å’Œ @layer è§„åˆ™.


å¦‚æœæƒ³è¦åœ¨å·²ç»å£°æ˜çš„çº§è”å±‚ä¸­è¿½åŠ æ ·å¼, å†™æ³•ä¸å£°æ˜æ—¶ä¸€æ ·, ä½†ä¸æ˜¯è¦†ç›–è€Œæ˜¯è¿½åŠ .
```css
@layer layer1 {
  .box2 {
    width: 100px;
    height: 100px;
  }
}
@layer layer1 {
  .box2 {
    background: salmon;
    border-radius: 10px;
  }
}
```
![](../image/Snipaste_2023-02-01_09-10-46.png)

## åµŒå¥—çš„ @layer
@layer è§„åˆ™æ˜¯å¯ä»¥åµŒå¥—çš„.
```css
@layer outer {
  @layer inner {
    .box3 {
      width: 100px;
      height: 100px;
      border: 1px solid red;
    }
  }
}
```
![](../image/Snipaste_2023-02-01_09-16-33.png)

å¦‚æœæƒ³è¦å‘å†…å±‚çš„ @layer æ·»åŠ æ–°çš„æ ·å¼, å¯ä»¥æŠŠå†…å¤–å±‚çš„åå­—ä½¿ç”¨ `.` è¿æ¥
```css
@layer outer.inner {
  .box3::before {
    content: 'ğŸ°'
  }
}
```

å¦‚æœæˆ‘ä»¬ç›´æ¥è¿½åŠ æ²¡æœ‰å£°æ˜è¿‡çš„çš„çº§è”å±‚å‘¢? æ¯”å¦‚ä¸‹é¢ä»£ç ä¸­, å¢åŠ äº†ä¸€ä¸ªä¸å­˜åœ¨çš„å¤–å±‚ outerDontKnow å’Œä¸å­˜åœ¨çš„ å†…å±‚ inner; è¿˜åœ¨å­˜åœ¨çš„å¤–å±‚ä¸­å¢åŠ äº†ä¸å­˜åœ¨çš„å†…å±‚ innerDontKnow, æ‰€ä»¥æœ€åæœ‰å‡ ä¸ªå…”å­å‘¢?
```css
@layer outer.inner {
  .box3::before {
    content: 'ğŸ°'
  }
}
@layer outerDontKnow.inner {
  .box3::before {
    content: 'ğŸ°ğŸ°'
  }
}
@layer outer.innerDontKnow {
  .box3::before {
    content: 'ğŸ°ğŸ°ğŸ°'
  }
}
```
ç­”æ¡ˆæ˜¯ğŸ°ğŸ°, å› ä¸º @layer outerDontKnow.inner å°±æ˜¯å£°æ˜äº†æ–°çš„çº§è”å±‚, å…¶ä¼˜å…ˆçº§æ¯”å·²ç»å­˜åœ¨çš„ outer æ›´é«˜.

![](../image/Snipaste_2023-02-01_09-27-31.png)

çº§è”å±‚å†…éƒ¨çš„ä¼˜å…ˆçº§è§„åˆ™ä¸æœ€å¤–å±‚çš„çº§è”å±‚ä¼˜å…ˆçº§è§„åˆ™ç›¸åŒ, 
```css
@layer outer1 {
  .box4 {
    width: 100px;
    height: 100px;
    border: 3px solid red;
  }
  @layer inner1 {
    .box4 {
      background: red;
    }
  }
  @layer {
    .box4 {
      background: pink;
      border: 1px solid blue;
    }
  }
}
```
å†…éƒ¨åŒ¿åçº§è”å±‚çš„ä¼˜å…ˆçº§é«˜äº inner1, è€Œæ²¡æœ‰å£°æ˜åœ¨çº§è”å±‚ä¸­ä¼˜å…ˆçº§åˆé«˜äºå†…éƒ¨åŒ¿åçº§è”å±‚çš„ä¼˜å…ˆçº§
![](../image/Snipaste_2023-02-01_21-03-26.png)

### å†…å±‚çš„ä¼˜å…ˆçº§.

## @layer ä¸ !important

## æµè§ˆå™¨å…¼å®¹æ€§

`@layer`



![](../image/)
è°¢è°¢ä½ çœ‹åˆ°è¿™é‡ŒğŸ˜Š
