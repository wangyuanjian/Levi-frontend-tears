<!-- TOC -->

- [两种时间线timeline](#%E4%B8%A4%E7%A7%8D%E6%97%B6%E9%97%B4%E7%BA%BFtimeline)
- [Scroll Progress Timeline](#scroll-progress-timeline)
- [View Progress Timeline](#view-progress-timeline)

<!-- /TOC -->
## 两种时间线(timeline)
我不知道中文该怎么翻译我就不翻译了...😅 但是有必要解释一下这个新的名词是什么意思, 时间线就是用来推动动画进度的.
- `scroll progress timeline`: 通过从上到下(或从左到右)滚动一个可滚动元素(也被称为 `scrollport` 或 `scroller`)来推进这个时间线. 滚动过程中的位置被转化为滚动进度的百分比——滚动刚开始是 `0%`, 滚动结束是 `100%`. 📖这个过程是可以反复的, 即上下(或左右)来回滚动.
  - ![](../image/scroll-progress-time-example.gif)
  - 📖 这个定义并不严谨, 因为 `scrollport` 实际上应该是 `scroller` 除去其 `padding box` 的区域.
- `view progress timeline`: 这个时间线是基于元素(`subject`)在滚动容器(`scroller`)中的`可见性`变化. 也就是说, 元素在容器的可见性被转化为百分比——默认情况下, 当元素刚刚出现在容器边缘时, 为 `0%`, 当元素完全离开, 为 `100%`.
  - 可以类比 `IntersectionObserver` 是如何工作的.
  - ![](../image/view-progress-time-example.gif)
  - 实际上, 开发人员可以决定元素 `0%` 从哪里开始, `100%` 到哪里结束, 这是后话, 涉及 `animation-range` 属性.

对比两个时间线, 可以发现他们都会追踪 `scroller` 的滚动偏移, 但是 `view progress timeline` 是根据元素在 `scroller` 中的位置决定整个滚动进度.

除了上面提到的两种时间线, 还有一种默认的[文档时间线(document timeline)](https://developer.mozilla.org/en-US/docs/Web/CSS/animation-timeline), 从页面加载完成开始. 文档时间线传统上与 `CSS` 的 `animation` 相关, 如果不设定 `animation-timeline` 属性或者设置为 `auto`, 就是文档时间线.

## Scroll Progress Timeline
通过 `animation-timeline` 属性, 指定用于控制 `CSS` 动画进度的时间线, 如果是 `scroll progress timeline` 需要 `animation-timeline` 的值为 [scroll()](https://developer.mozilla.org/en-US/docs/Web/CSS/animation-timeline/scroll). 上面动图的例子
```css
@keyframes bg-scroll { ... }
.bg {
  animation: bg-scroll linear forwards;
  animation-timeline: scroll();
}
```
首先, `animation` 简写属性并不包含 `animation-timeline`, 因此必须单独声明. 另外 `animation-timeline` 必须声明在 `animation` 后面因为 `animation-timeline` 会重置所有 `animation` 中没有出现的属性为初始值.
## View Progress Timeline
将 `animation-timeline` 的值设置为 [view()](https://developer.mozilla.org/en-US/docs/Web/CSS/animation-timeline/view), 即可创建用于控制 `CSS` 动画进度的 `view progress timeline`.
```css
@keyframes bg-scroll { ... }
.bg {
  animation: bg-scroll linear forwards;
  animation-timeline: view();
}
```
比起 `scroll()`, 我们可以通过 `view-timeline-inset` 控制动画的更多部分.


谢谢你看到这里😊